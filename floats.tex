\newcommand{\figOverview}{ 
\begin{figure*}[t]
	\centering
	\includegraphics[width=0.9\linewidth]{figures/pdf/overview-crop.pdf}	
	\caption{This thesis contributes a new energy-efficient system stack: \sonic is a software framework that enables intermittent inference, \riptide compiles C-code to ULP CGRAs, \manic is an ULP vector-dataflow co-processor, \snafu generates ULP CGRAs, and \msilicon is a silicon prototype of \manic.}
	\label{fig:overview}
\end{figure*}
}

\newcommand{\figDevice}{ 
\begin{figure*}[htb]
	\centering
	\includegraphics[width=0.9\linewidth]{figures/pdf/device-crop.pdf}	
	\caption{Typical ULP device is composed of 1) series of sensors (e.g. camera, microphone, GPS, accelerometer, etc.), 2) low-power radio (e.g. LoRaWAN or BLE), 3) low-power microcontroller, the focus of this thesis, 4) power source like a battery or capacitor and 5) an optional energy harvester like a solar cell.}
	\label{fig:device}
\end{figure*}
}

\newcommand{\figPower}{ 
\begin{figure*}[htb]
	\centering
	\includegraphics[width=0.7\linewidth]{figures/pdf/power-crop.pdf}	
	\caption{This thesis presents work (\snafu and \riptide) that targets the ULP domain, 2--3 orders of magnitude less than prior work.}
	\label{fig:power}
\end{figure*}
}

\newcommand{\tabMotivate}{
  \begin{table*}[htb]
  \centering
  \scriptsize
  \resizebox{\linewidth}{!}{
  \begin{tabular}{l|p{0.7in}p{0.7in}p{0.7in}|p{0.7in}p{0.7in}p{0.7in}|p{0.7in}p{0.7in}}
    \toprule
	& \multicolumn{3}{c|}{\bf Ultra-low-power CGRAs} & \multicolumn{3}{c|}{\bf High-performance CGRAs} \\[.5ex]
    & \bf ULP-SRP~\cite{srp} & \bf CMA~\cite{cma} & \bf IPA~\cite{ipa} & \bf HyCube~\cite{karunaratne2017hycube} & \bf Revel~\cite{weng2020hybrid} & \bf SGMF~\cite{voitsechov2014single} & \bf \snafu~\cite{snafu} & \bf \riptide \\
    \midrule
    \bf Fabric size         & 3$\times$3                                     & 8$\times$10        & 4$\times$4         & 4$\times$4                              & 5$\times$5                         & 8$\times$8 + 32 mem                  & N$\times$N (6$\times$6 evaluated) & N$\times$N (6$\times$6 evaluated) \\[.5ex]
    \bf NoC                 & Neighbors only                                 & Neighbors only     & Neighbors only     & Static, bufferless, multi-hop           & Static \& dynamic NoCs (2$\times$) & Dynamic routing                      & Static, bufferless, multi-hop & Static, bufferless, multi-hop       \\[.5ex]
    \bf PE assignment       & Static                                         & Static             & Static             & Static                                  & Static \emph{or} dynamic           & Dynamic                              & Static  & Static                              \\[.5ex]
    \bf Time-share PEs?     & Yes                                            & Yes                & Yes                & Yes                                     & Yes                                & Yes                                  & No               & No                   \\[.5ex]
    \bf Scheduling/PE firing           & Static                                         & Static             & Static             & Static                                  & Static \emph{or} dynamic           & Dynamic                              & Dynamic                  & Dynamic           \\[.5ex]
    \bf Heterogeneous PEs?  & No                                             & No                 & No                 & No                                      & Yes                                & Yes                                  & Yes               & Yes                  \\[.5ex]
    \bf Program support & VLIW/Simple loops$^1$            & VLIW/Simple loops$^1$      &  Simple loops$^1$                             & Simple loops$^1$                & Arbitrary (CUDA-like)                      & Loops that fit patterns & Vectorizeable loops & Arbitrary                    \\[.5ex]
    \midrule
    \bf Power               & 22\,mW                                         & 11\,mW             & 3--5\,mW           & 15--70\,mW                              & 160\,mW                            & 20\,W                                & $<$1\,mW               & $<$1\,mW           \\[.5ex]
    \bf MOPS/mW (approx.)   & 30--100                                        & 100--200           & 140                & 60--90                                  & 60                                 & 60                                   & 305 (fabric)      & 438 (fabric)                  \\[.5ex]
    \bottomrule
  \end{tabular}

  }
	
	$^1$ Simple loops are singly-nested and have few loop-carried dependence.

  \caption{Architectural comparison of prior work to \snafu and \riptide.}
  \label{tab:motivation}
\end{table*}
}

\newcommand{\figFutureModel}{
  \begin{figure}[htb]
    \centering
    \includegraphics[height=0.325in]{figures/pdf/future_model_legend-crop.pdf} 

    \vspace{0.5em}

    \includegraphics[width=0.6\linewidth]{figures/pdf/future_model-crop.pdf} 
    \caption{Device lifetime as a function of problem size. A \riptide based system smartly discarding uninteresting data achieves similar lifetime to a theoretical system with a 10TOPS/W processor. \riptide (Summary), which only transmits a summary of captured data, increases lifetime even more.}
    \label{fig:future:model}
  \end{figure}
}

\newcommand{\figProgress}{
  \begin{figure}[htb]
    \centering

    \begin{subfigure}{0.32\linewidth}
      \centering
      \includegraphics[width=0.9\linewidth]{figures/pdf/progress_energy-graph-crop.pdf}
      \caption{Energy savings.}
      \label{fig:progress:energy}
    \end{subfigure}
    \hfill
    \begin{subfigure}{0.32\linewidth}
      \centering
      \includegraphics[width=0.9\linewidth]{figures/pdf/progress_eff-graph-crop.pdf}
      \caption{Efficiency.}
      \label{fig:progress:eff}
    \end{subfigure}
    \hfill
    \begin{subfigure}{0.32\linewidth}
      \centering
      \includegraphics[width=0.9\linewidth]{figures/pdf/progress_perf-graph-crop.pdf}
      \caption{Speedup.}
      \label{fig:progress:perf}
    \end{subfigure}

    \caption{Energy savings, efficiency, and speedup v. MSP430 for neural network inference. \riptide saves $1676\times$ energy and is $235\times$ faster v. the MSP430.}
    \label{fig:progress}
  \end{figure}
}